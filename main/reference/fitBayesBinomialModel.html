<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Given a set of event counts and patient numbers for multiple sites,
where the event can occur at most once per patient, fit a Bayesian
hierarchical Binomial model to the site-specific event counts."><title>Fit an MCMC Binomial Model to site-specific Counts — fitBayesBinomialModel • rbqmR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit an MCMC Binomial Model to site-specific Counts — fitBayesBinomialModel"><meta property="og:description" content="Given a set of event counts and patient numbers for multiple sites,
where the event can occur at most once per patient, fit a Bayesian
hierarchical Binomial model to the site-specific event counts."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rbqmR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fit an MCMC Binomial Model to site-specific Counts</h1>
      
      <div class="d-none name"><code>fitBayesBinomialModel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given a set of event counts and patient numbers for multiple sites,
where the event can occur at most once per patient, fit a Bayesian
hierarchical Binomial model to the site-specific event counts.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fitBayesBinomialModel</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">n</span>,</span>
<span>  <span class="va">r</span>,</span>
<span>  model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  inits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nChains <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">inits</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">inits</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>The data.frame containing the participant and event counts</p></dd>


<dt>n</dt>
<dd><p>The column in <code>data</code> containing the participant counts.  Uses
tidy evaluation</p></dd>


<dt>r</dt>
<dd><p>The column in <code>data</code> containing the event counts.  Uses tidy
evaluation</p></dd>


<dt>model</dt>
<dd><p>The character string containing the JAGS model to be fitted.  If
<code>NULL</code>, obtained from <code>getModelString("binomial)</code>.</p></dd>


<dt>inits</dt>
<dd><p>A list of JAGS inits lists suitable for use with this model.  If
<code>NULL</code> (the default), <code>nChains</code> random inits are generated by
<code><a href="dot-createBinomialInit.html">.createBinomialInit</a></code>.</p></dd>


<dt>nChains</dt>
<dd><p>The number of chains to use.  Default 2.  If <code>inits</code> is not
<code>NULL</code>, must equal <code>length(inits)</code> or be <code>NULL</code>.</p></dd>


<dt>...</dt>
<dd><p>passed to .createBinomialInits or .autorunJagsAndCaptureOutput</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A tibble with four columns</p>
<dl><dt>p</dt>
<dd><p>Simulated values from the posterior distribution of the event
probabilities.</p></dd>

<dt>shape1</dt>
<dd><p>Simulated values from the posterior distribution of the first
shape parameter of the Beta distribution for <code>p</code>.</p></dd>

<dt>shape2</dt>
<dd><p>Simulated values from the posterior distribution of the second
shape parameter of the Beta distribution for <code>p</code>.</p></dd>

<dt>q</dt>
<dd><p>Percentile in which each p value falls.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The count of patients experiencing an event at a given site is
assumed to follow a Binomial distribution, a standard statistical
distribution that expresses the probability of a given number of
events out of a fixed number of possible events. The probability
depends on a site-specific probability for the event to occur for a
single patient <code>p_i</code> and the total number of patients at
each site.
The site-specific probabilities, <code>p_i</code>,
are assumed to follow a Beta distribution; a continuous
distribution of values between 0 and 1, with two parameters, <code>a</code>
and <code>b</code>, that determine the shape and skewness of the
distribution.
Uncertainty in the parameters of the Beta distribution is accounted
for by specifying prior distributions on these parameters. These
"hyperpriors" are specified as Gamma distributions.</p>
<p>The parameters of the hyper-priors are specified by <code>a</code> and <code>b</code>.
The default settings specify Gamma(1, 10) distributions which allow
bell-shaped distributions for <code>0.05 &lt; p_i &lt; 0.95</code>, but put a low
probability of very precise distributions.</p>
<p>The Bayesian Hierarchical Model then estimates the posterior distribution
for the unknown parameters <code>p_i</code>, <code>a</code> and <code>b</code>,
given the observed events. Under Bayes Theorem this is proportional to the
likelihood of the observed data given the parameters multiplied by the prior
for the parameters. The prior can be informed by historical data and/or
expert knowledge. As more data are available, the posterior is less
influenced by the prior and more influenced by the data.</p>
<p>The exact posterior distribution cannot be computed directly, hence a Markov
Chain Monte Carlo (MCMC) method is used to simulate values of
<code>p_i</code>, <code>a</code> and <code>b</code> from the posterior distribution.
Any number Markov chains can be used, each with a minimum of 10,000 values
simulated after 4000 burn-in iterations and 1000 adaptive iterations.
The chains are checked for convergence and the simulation is extended if
required to satisfy basic convergence tests. The samples from all chains are
combined in the returned value.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">berrySummary</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>             <span class="fu">fitBayesBinomialModel</span><span class="op">(</span></span></span>
<span class="r-in"><span>               n<span class="op">=</span><span class="va">Subjects</span>,</span></span>
<span class="r-in"><span>               r<span class="op">=</span><span class="va">Events</span></span></span>
<span class="r-in"><span>             <span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by John Kirkpatrick.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

